import { NextResponse } from "next/server";

export async function POST(req: Request) {
  const { message } = await req.json();

  if (!message) {
    return NextResponse.json({ error: "Message is required" }, { status: 400 });
  }
  const mainPrompt = `
ุชู ูพุดุชุจุงู ุณุงุช "ูุฑุฒุด" ูุณุช. 
ูุธููโุช ููุท ูพุงุณุฎโุฏุงุฏู ุจู ุณูุงูโูุง ู ูุดฺฉูุงุช ฺฉุงุฑุจุฑุงู ุฏุฑุจุงุฑูโ ุณุงุช "ูุฑุฒุด" ุงุณุช.

๐น ุชูุถุญ ุณุงุช:
"ูุฑุฒุด" ฺฉ ูุจโุณุงุช ุจุฑุง ุฏูุจุงูโฺฉุฑุฏู ุฏูุง ูุฑุฒุด ุงุณุช ฺฉู ุดุงูู ุงุฎุจุงุฑุ ููุงูุงุชุ ูพุงุฏฺฉุณุชโูุง ู ูุทุงูุจ ูุฑุฒุด ูุฎุชูู ูโุดูุฏ. 
ุณุงุฒูุฏฺฏุงู ุงู ุณุงุช ููุฏ ู ุงูุฑูุญูุฏ ูุณุชูุฏ.

๐น ุฏุณุชูุฑุงูุนูู ูพุงุณุฎโุฏู:
- ููุท ุฏุฑุจุงุฑูโ ุจุฎุดโูุงุ ุนููฺฉุฑุฏุ ูุดฺฉูุงุช ูู ุง ูุญุชูุง ุณุงุช ูพุงุณุฎ ุจุฏู.
- ุงฺฏุฑ ฺฉุงุฑุจุฑ ุณูุงู ุฎุงุฑุฌ ุงุฒ ููุถูุน ุณุงุช ูพุฑุณุฏุ ุจฺฏู ฺฉู ููุท ุฏุฑ ููุฑุฏ ุณุงุช "ูุฑุฒุด" ูพุงุณุฎ ูโุฏ.
- ูพุงุณุฎโูุง ุจุงุฏ ฺฉูุชุงูุ ุฏูู ู ููุฏุจุงูู ุจุงุดูุฏ.
- ุงุฒ ุชูุถุญุงุช ุงุถุงูุ ุดูุฎ ุง ุงุทูุงุนุงุช ูุงูุฑุชุจุท ุฎูุฏุฏุงุฑ ฺฉู.
- ุงฺฏุฑ ูพุฑุณุฏู ุดุฏ ุจู ุณุงุฒูุฏู ูุง ุณุงุช ููุฏ ุจูุชุฑู ุง ุงููุญูุฏ ุจฺฏู ูุทุนุง ููุฏ ุจูุชุฑู ฺูู ููู ุงุณุชฺฉ ุณููุฑ ูุณุช 

ูพุงู ฺฉุงุฑุจุฑ:
`;

  try {
    const res = await fetch(
      `https://text.pollinations.ai/prompt/${encodeURIComponent(
        mainPrompt + message
      )}`
    );

    const text = await res.text();

    return NextResponse.json({ reply: text });
  } catch (error) {
    console.log(error);
    return NextResponse.json(
      { error: "Faild to connect to Ai" },
      { status: 500 }
    );
  }
}
